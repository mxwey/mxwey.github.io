---
title: "test1"
date: 2023-02-10T17:13:39+08:00
---
## Introduction

This is **bold** text, and this is *emphasized* text.

Visit the [Hugo](https://gohugo.io) website!


```golang
package main

main(){
    s := []string{1,2,3}
}


```

### 一、I/O子系统概述

- 解决：各种I/O设备的功能和传输速率差异巨大
- 包括：I/O调度、缓冲与高速缓存、设备分配与回收、假脱机、设备保护、差错处理等。



### 二、I/O调度概念

定义：确定一个好的顺序来执行这些I/O请求。

- 使设备公平地共享设备访问。
- 减少I/O完成所需的平均等待时间。

### 三、高速缓存与缓冲区

#### 1、磁盘高速缓存（Disk Cache）

- 提高磁盘的I/O速度
- 用内存存储空间暂存盘块中的信息
- 属于逻辑上的磁盘
- 物理上是驻留在内存中的盘块
- 两种形式：
  - 内存中开辟一个单独空间
  - 把未利用的内存空间作为一个缓冲池

#### 2、缓冲区（Buffer）

目的：

- 缓和CPU与I/O间速度不匹配的矛盾。
- 减少对CPU的中断频率。
- 解决基本数据单元不匹配问题。
- 提高CPU与I/O设备之间的并行性。

实现方法：

- 采用硬件缓冲器，成本高。
- 采用缓冲区（内存区域）。（非空，只能传出；空，只能传入）

缓冲技术分类：

- 单缓冲。

  - 设备与处理机之间设置一个缓冲区。
  - 初始状态：工作区满，缓冲区空，大小相等（默认）

  <img src="https://cms.weilogs.com/image/20211227172013.png" alt="image-20211227171954720" style="width:100%;" />

  

- 双缓冲。

<img src="https://cms.weilogs.com/image/20211227172059.png" alt="image-20211227172043500" style="width:100%;" />

<img src="https://cms.weilogs.com/image/20211227172218.png" alt="image-20211227172152983" style="width:100%;" />

结论：采用双缓冲策略，处理一个数据块的平均耗时为 Max (T, C+M)

- 循环缓冲。
- 缓冲池。

#### 3、 高速缓存与缓冲区的对比

<img src="https://cms.weilogs.com/image/20211227173021.png" alt="image-20211227173005212" style="width:100%;" />

### 四、设备分配与回收

#### 1、设备分配概述

概念：根据用户I/O请求分配所需的设备。

总原则：充分发挥设备使用效率，尽可能让设备忙碌起来。

三种方式：

- 独占式使用设备。打印机
- 分时式共享使用设备。对磁盘的I/O操作，进程每次分时交替进行。
- 以SPOOLing方式使用外部设备。
  - 以空间换时间
  - 假脱机I/O技术
  - 对I/O操作进行批处理

#### 2、设备分配的数据结构

- 设备控制表（DCT）
- 控制器控制表（COCT）
- 通道控制表（CHCT）
- 系统设备表（SDT）

分配原则：

- I/O设备的固有属性
- 分配算法
- 分配的安全性
- 独立性

#### 3、设备分配的策略

- 设备分配原则。
  - 充分发挥使用效率
  - 避免死锁
  - 程序与设备隔离开
- 设备分配方式。
  - 静态分配。用于独占设备分配，一次性分配。不符合总原则。
  - 动态分配。在进程过程中按需分配。可能造成死锁。
- 设备分配算法。
  - 先请求先分配。
  - 优先级高者优先。

#### 4、设备分配的安全性

- 安全分配方式。
  - 发出I/O后就进入阻塞态。
  - 优点：安全
  - 缺点：CPU和I/O是串行工作的。
- 不安全分配方式。
  - 发出I/O后继续运行。所请求的设备被占用了，才阻塞。
  - 优点：一个进程可以同时操作多个设备。
  - 缺点：可能产生死锁。

#### 5、逻辑设备名到物理设备名的映射

设备独立性：应用独立于物理设备。

实现：应用中用**逻辑设备名**来请求使用某类设备。

建立逻辑设备表LUT，通过LUT寻找相应的物理设备和驱动。

- 整个系统只设置一张LUT。
- 为每个用户设置一张LUT。

### 五、SPOOLing技术（假脱机技术）

- 目的：缓和CPU的高速性与I/O设备低速性之间的矛盾。
- 又称假脱机输入/输出操作。

#### 1、输入井和输出井

- **磁盘**上2个存储区域。
- 输入井：收入I/O输入的数据
- 输出井：模拟脱机输出时的磁盘

#### 2、输入缓冲区和输出缓冲区

- **内存中**的两个缓冲区
- 输入缓冲区：暂存输入
- 输出缓冲区：暂存从输出井来的数据

#### 3、输入进程和输出进程

#### 4、特点：

- 提高了I/O的速度
- 独占设备->共享设备
- 实现虚拟设备功能
- 以**空间换时间**

### 六、小结

1. 当处理机和外部设备速度差距较大时，并且此时不想让其中一方等待，有什么办法可以解决问题？

   可以采用缓冲技术来缓解处理机与外部设备速度上的矛盾，即在某块地方（一般为主存）设立一片缓冲区，外部设备与处理机的输入/输出都经过缓冲区，这样外部设备和处理机就都不用互相等待。

2. 什么是设备的独立性？引入设备的独立性有什么好处？

   设备独立性是指用户在编程序时使用的设备与实际设备无关。一个程序应独立于分配给它的某类设备的具体设备，即在用户程序中只指明I/O使用的设备类型即可。

   

   设备独立性有以下优点

   - 方便用户编程。
   - 使程序运行不受具体机器环境的限制。
   - 便于程序移植。
